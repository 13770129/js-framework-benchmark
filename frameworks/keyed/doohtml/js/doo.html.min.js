!function(t){var e={};function a(l){if(e[l])return e[l].exports;var i=e[l]={i:l,l:!1,exports:{}};return t[l].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=e,a.d=function(t,e,l){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:l})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var l=Object.create(null);if(a.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(l,i,function(e){return t[e]}.bind(null,i));return l},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=0)}([function(t,e,a){"use strict";a.r(e),a.d(e,"DooHTML",(function(){return i}));
/*!
 doo.html.min.js
 ===============
 * JavaScript WebComponent Framework
Copyright Â© 2019-2023 Henrik Javen

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

	http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
const l={NAME:"DooHTML",DATA_BIND:"bind",TEMPLATE_EXT:".html",COMPONENT_DIR:"/components",TYPE:{DEFAULT:0,ENUM:1,DEEP:2,COMPUTED:3},MATCH:{ANY:-1,STARTS_WITH:0,EXACT:1},DELIMITER:{BEG:"{{",END:"}}"},DOCUMENT:"document",SHADOW:"shadow",FLEX_BODY:".fbody",PAGE_SIZE:12,DATA_STORE:"data-store",DATA_KEY:"data-key",DATA_SCROLL_CONTAINER:".fbody",DATA_SCROLL_HEADER:".fhead"};class i extends HTMLElement{static get version(){return"v0.91.1-beta"}static define(t,e=null){let a=e||t.name.toLowerCase();customElements.define("doo-"+a,t)}constructor(t=l.PAGE_SIZE){super(),this.PAGE_SIZE=t,this.data={},this.place=[],this.template=void 0,this.visibleColumns=[],this.hasHtml=!1}static get observedAttributes(){return["doo-refresh","data-has-html","data-src","data-key","data-template","bind","data-page","data-page-size","page-size"]}async attributeChangedCallback(t,e,a){a.length>0&&e!==a&&("doo-refresh"===t&&this.dataset.store?await this.render(Doo.X.getData(this.getAttribute("bind"))):"page-size"===t?this.PAGE_SIZE=a:"data-key"===t?this.dataKey=a:"data-has-html"===t?this.dataHasHtml=a:"debug"===t&&(Doo.debug=!0))}dooParse(t){let e=t.cloneNode(!0);e.removeAttribute(l.DATA_BIND),e.removeAttribute("data-key");let a=e.outerHTML.replace(/\t/g,"").replace(/\n/g,""),i=a;["src","selected","checked","disabled","readonly"].forEach(t=>{a=a.replace(new RegExp(" "+t+'="{{(.+)}}"',"g")," doo-"+t+'="{{$1}}"')});let n,s=i===a,o=a.split(l.DELIMITER.END),r=[],h=o.length;for(let t=0;t<h;t++)if(l.DELIMITER.BEG.includes(l.DELIMITER.BEG)){n=o[t].split(l.DELIMITER.BEG);let e=n[0].lastIndexOf(">");t<h-1?e===n[0].length-1?(n[0]=n[0].substring(0,e)+` data-of="${n[1]}">`,r.push(n[0]),r.push("")):r.push(n[0]):r.push(o[t])}let d=document.createElement("template");return d.innerHTML=r.join(""),{templateArray:r,processNode:d.content.firstElementChild,xHtml:s}}initReactiveDataNodes(t){const e=t=>{let e=0;for(;t.parentElement;)t=t.parentElement,e++;return e};this.dataMap=null,this.flex=null,this.hasAttribute("data-map")&&(0===this.getAttribute("data-map").indexOf("Doo.reflect")?this.dataMap=Reflect.ownKeys(DooX.getData(this.getAttribute(l.DATA_BIND))[0]):this.dataMap=this.getAttribute("data-map").split("|")),this.hasAttribute("flex")&&(this.flex=this.getAttribute("flex").replace("[","").replace("]","").split("|"));let a=t.content.querySelectorAll('[data-src="${data-map}"]');a.length>0&&[...a].forEach(t=>{let e=[];this.dataMap.forEach((t,a)=>{let l=void 0===this.flex[a]?1:this.flex[a],i=t.split(":"),n=i.length>1?i[1]:i[0],s="";l.includes(":")&&(s=l.split(":").length>2?"doo-center":"doo-end",l=l.replace(/:/g,"")),e.push({label:n,fieldName:this.dynamicField(i[0]),flex:l,flexJustify:s})});let a=this.htmlParse(t,e),l=t.parentElement;l.removeChild(t),l.innerHTML=a+l.innerHTML}),t.innerHTML=t.innerHTML.replace(/\$\{(.+?)\}/gm,(e,a)=>isNaN(a)?this.hasAttribute(a)?this.getAttribute(a):t.hasAttribute(a)?t.getAttribute(a):"":this.dataMap.length>0?l.DELIMITER.BEG+this.dataMap[a-1]+l.DELIMITER.END:void 0),[...t.content.querySelectorAll("["+l.DATA_BIND+"]")].forEach(t=>{if(!t.hasAttribute("data-src")){let e=this.hasAttribute("doo-dispatch")?"DooX":"this.data";t.setAttribute("data-src",e)}});let i,n,s=t.content.querySelectorAll("[data-src]"),o=s.length,r=0,h=[];for(r=0;r<o;r++){let t=s[r].getAttribute(l.DATA_BIND),a=s[r].getAttribute("data-src");a&&(this.setAttribute("doo-dispatch",t),n=a.trim()),0===a.indexOf("this.parent")&&(s[r].useParent=!0),s[r].removeAttribute("data-src"),s[r].level=e(s[r]),h.push(s[r])}this.removeAttribute("data-map"),this.removeAttribute("flex"),this.removeAttribute("data-fetch");for(h.sort((t,e)=>t.level===e.level?0:t.level>e.level?1:-1).reverse(),r=0;r<o;r++){i="|STYLE|LINK|".indexOf(`|${h[r].tagName}|`)>-1?h[r]:h[r].parentElement&&("void"===s[r].getAttribute(l.DATA_BIND)||"|DL|UL|TBODY|THEAD|TFOOT|TR|SELECT|SECTION|".indexOf(`|${h[r].parentElement.tagName}|`)>-1)?h[r].parentElement:document.createElement("data"),i.dataKey=h[r].getAttribute(l.DATA_BIND);let t=this.dooParse(h[r],this,this.dataMap);i.templateArray=t.templateArray,i.processNode=t.processNode,i.xHtml=t.xHtml,i.name=r,i.level=e(h[r]),i.useParent=h[r].useParent,i.noRepeat=h[r].hasAttribute("data-norepeat"),"DATA"!==i.tagName&&"STYLE"!==i.tagName&&"LINK"!==i.tagName||(h[r].parentElement?h[r].parentElement.replaceChild(i,h[r]):(console.log("Warning: Templates should only have one childnode"),h[r].appendChild(i))),this.place.push(i)}return this.place}async setContext(){this.childNodes.length>0&&this.getElementsByTagName("template")&&this.getElementsByTagName("template").length>0&&this.removeChild(this.getElementsByTagName("template").item(0));let t=this.getAttribute("context")||l.SHADOW;if(t===l.SHADOW){this.componentContainer=this.shadow.host,this.showComponentContainer(!1);let t=this.templateElem.firstElementChild.hasAttribute("class")?" "+this.templateElem.firstElementChild.getAttribute("class"):"",e=this.hasAttribute("class")?this.getAttribute("class")+" ":"";e+t!==""&&this.templateElem.firstElementChild&&this.templateElem.firstElementChild.setAttribute("class",`${e}${t}`),this.shadow.appendChild(this.templateElem)}else t===l.DOCUMENT&&(this.componentContainer=this.parentElement,this.showComponentContainer(!1),this.componentContainer.replaceChild(this.templateElem,this));this.initialHeight=this.shadow.firstElementChild.offsetHeight}getItemValue(t,e){return t[e]}renderHTML(t,e,a=0,l=this.PAGE_SIZE){let i,n,s,o,r,h=e.length,d=a+l,c=String("[data-of]");d>h&&(d=h);for(let l=a;l<d;l++)i=t.processNode.cloneNode(!0),i[this.dataKey]=e[l][this.dataKey],t.appendChild(i);s=t.querySelectorAll(t.processNode.tagName),o=t.firstElementChild.querySelectorAll(c),n=t.querySelectorAll(c),r=o.length;let p=-1;for(let t=0,a=n.length;t<a;t++)t%r==0&&p++,n[t].textContent=e[p][n[t].dataset.of],n[t].removeAttribute("data-of")}async showComponentContainer(t=!0){this.componentContainer&&(this.componentContainer.style.visibility="visible")}renderTable(t=this.data[this.defaultDataSet],e=this.place[0],a=0){let l=t.length;0!==l?(e.childNodes.length>l&&(e.textContent=""),this.renderHTML(e,t,a,l-a)):e.textContent=""}append(t=this.data[this.defaultDataSet],e=this.place[0],a=0){this.renderHTML(e,t,a,t.length-a,!0)}getIndex(t){return this.data.rows.findIndex((e,a)=>{if(e.id===t.key)return a})}render(t=null,e=0,a=null){if(!this.template)return console.error(this.name+" has no template defined"),console.log("You need to set a data-template attribute on the <doo-html /> component"),console.log("You can referense you data-template by a template id"),console.log('Example: <doo-html data-template="#t1" .../>'),console.log("Templates can also be external and you can use reletive path to access it"),void console.log('Example: <doo-html data-template="./templates/t1.html" .../>');this.place||console.log("No target set on the component or inside the template. USAGE: set the data-bind=[your data pointer]");for(let i=0,n=this.place.length;i<n;i++){if("TR"!==this.place[i].tagName&&"TBODY"!==this.place[i].tagName&&"TABLE"!==this.place[i].tagName||this.renderTable(t,this.place[i],e),t&&t!==this.place[i].dataKey)continue;if(0===e&&"STYLE"!==this.place[i].tagName&&!this.place[i].classList.contains("fhead")){let t="dummy"===this.place[i].getAttribute(l.DATA_BIND)?-1:0;this.place[i].setAttribute("page",t)}let n=this.place[i].dataKey,s=this.place[i].noRepeat?1:this.PAGE_SIZE;null===a?this.renderHTML(this.place[i],n,e*this.PAGE_SIZE,s):this.place[i].append(this.renderHTML(this.place[i],n,a,1))}return e}async connectedCallback(){let t=this.getAttribute("context")||l.SHADOW;this.shadow=t===l.SHADOW?this.attachShadow({mode:"open"}):document,!this.defaultDataSet&&this.getAttribute("bind")&&(this.defaultDataSet=this.getAttribute("bind"));this.constructor.name.toLowerCase();this.scrollTarget&&(this.scrollElem=this.shadow.querySelector(this.scrollTarget)),this.template=this.getAttribute("template"),this.templateNode=await this.createDooTemplate(this.template),this.templateElem=this.templateNode.content,this.initReactiveDataNodes(this.templateNode),this.setContext(),window.dooAfterRender&&"function"==typeof window.dooAfterRender&&window.dooAfterRender(),this.render([],this.place[0]),"function"==typeof this.dooAfterRender&&await this.dooAfterRender()}fetchTemplate(t){return new Promise((e,a)=>{const l=new XMLHttpRequest;l.open("GET",t),l.onload=()=>e(l.responseText),l.onerror=()=>a(l.statusText),l.send()})}async createDooTemplate(t){let e="";e=0===t.indexOf("#")?document.querySelector(t).outerHTML:await fetchTemplate(url);let a=document.createElement("div");a.innerHTML=e,a.querySelector("template")&&(a.innerHTML=a.querySelector("template")?e:`<template><center><pre>The template you are trying to import does not have a &lt;template&gt tag</pre><div style="color:red">${this.template}</div></enter></template>`);let l=a.querySelector("template").cloneNode(!0);l.removeAttribute("id");let i=document.createElement("template");i.innerHTML=l.innerHTML;let n=i.content,s=n.querySelectorAll("style");return s&&s.length>0&&n.appendChild(s[0]),i}}window.DooHTML||(window.Doo=i,window.DooHTML=i),i.define(i,"html"),e.default=i}]);